<html>
<head>
    <title>reCAPTCHA demo: Simple page</title>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<script>

  async function checkfunc() {
    console.log("reCAPTCHA result")
    const resp = grecaptcha.getResponse()
    console.log('resp=', resp)
    document.getElementById('resp').innerText = resp

    //TODO: try to post to captcha service. INCOMPLETE

    //this is the GSN request we'll be signing on
    const request = {
      request: {},
      requestData: {}
    }
    const response = await fetch('/captcha-service', {
      mode: 'no-cors',
      method: 'POST',
      body: {
        gresponse: resp,
        userdata: request
      }
    })
    console.log('resp.status', response)
    const text = await response.text()
    console.log('resp.text=', text)
  }

</script>
<body>
<div class="g-recaptcha" data-sitekey="6LdZ4MIbAAAAAPliyu1Y_gVA0MCiDol6mY6cnn9Y"></div>
<br/>
<input type="submit" value="check" onclick="checkfunc()">

<div id=resp></div>
</body>
</html>
